var dkim = require("./dkim");
var body = "Hello world";
var headers = "From: \"Diogo Resende\" <dresende@thinkdigital.pt>\r\n"
            + "To: Diogo <diogorr@gmail.com>\r\n"
            + "Subject: DKIM Test\r\n"
            + "Content-Type: text/html\r\n"
            + "MIME-Version: 1.0";
var public_key = "-----BEGIN PUBLIC KEY-----\n"
               + "MEwwDQYJKoZIhvcNAQEBBQADOwAwOAIxALpl2rbzr9g3gn961dQXa5KY/FPYjIY4\n"
               + "gUIkSq1YtDzzjg0Y/Deby/TJzW2e2U01wwIDAQAB\n"
               + "-----END PUBLIC KEY-----";
var private_key = "-----BEGIN RSA PRIVATE KEY-----\n"
                + "MIHxAgEAAjEAumXatvOv2DeCf3rV1Bdrkpj8U9iMhjiBQiRKrVi0PPOODRj8N5vL\n"
                + "9MnNbZ7ZTTXDAgMBAAECMBJkqJ9zDoAUgjEYKu+B3CCcLhIMBVndS2Db8Hah4CHC\n"
                + "qwCngkPsWOR1P5Zk84PqUQIZAOHCOWosgilbgRbYuQajSN/uRQeNEXVVGQIZANNd\n"
                + "28yZstzlA6+mUTohXyU9i4AikYmBOwIYID4tFQzmSiHXffvV8SzA67qMAVgUdj2B\n"
                + "AhgVBYK0yJyHZ6eEMrBlbag+1e4n4khDOr0CGFvHxwW9wu04o1xYv7Yjw91PVI0V\n"
                + "N9huoA==\n"
                + "-----END RSA PRIVATE KEY-----";

console.log(dkim.sign(headers, body, private_key, "thinkdigital.pt", "mail"));


var pub_lines = public_key.split("\n"),
    txt_record = "mail._domainkey\tIN\tTXT\t\"v=DKIM1\\; k=rsa\\; g=*\\; s=email\; h=sha1\\; t=s\\; p=";

for (var i = 0; i < pub_lines.length; i++) {
	if (pub_lines[i].substr(0, 5) == "-----") continue;
	txt_record += pub_lines[i];
}
txt_record += ";\"";

console.log(txt_record);
